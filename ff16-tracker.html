<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Final Fantasy XVI - Walkthrough Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cormorant+Garamond:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        /* Iframe compatibility fixes */
        html, body {
            width: 100%;
            margin: 0;
            padding: 0;
        }

        html {
            height: auto;
            min-height: 100%;
            overflow-y: auto;
            overflow-x: hidden;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #14141c;
            --bg-tertiary: #1c1c28;
            --accent-fire: #d94a2b;
            --accent-ice: #4a9dd9;
            --accent-gold: #d4af37;
            --text-primary: #e8e8f0;
            --text-secondary: #a8a8b8;
            --border: #2a2a38;
            --completed: #2d7a4a;
            --shadow: rgba(217, 74, 43, 0.3);
        }

        body {
            background: linear-gradient(135deg, #0a0a0f 0%, #14141c 50%, #1c1c28 100%);
            background-attachment: fixed;
            color: var(--text-primary);
            font-family: 'Cormorant Garamond', serif;
            min-height: 100vh;
            width: 100%;
            padding: 1rem;
            position: relative;
        }

        @media (min-width: 768px) {
            body {
                padding: 2rem;
            }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 30%, rgba(217, 74, 43, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(74, 157, 217, 0.06) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            padding-bottom: 4rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding: 2rem;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg-tertiary) 100%);
            border: 2px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(217, 74, 43, 0.1), transparent);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }

        h1 {
            font-family: 'Cinzel', serif;
            font-size: 3.5rem;
            font-weight: 700;
            letter-spacing: 4px;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--accent-fire), var(--accent-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px var(--shadow);
            position: relative;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            letter-spacing: 3px;
            text-transform: uppercase;
            position: relative;
            margin-bottom: 1.5rem;
        }

        .youtube-link {
            display: inline-flex;
            align-items: center;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, #ff0000, #cc0000);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-family: 'Cinzel', serif;
            font-size: 1rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(255, 0, 0, 0.3);
        }

        .youtube-link:hover {
            background: linear-gradient(135deg, #ff3333, #ff0000);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 0, 0, 0.5);
        }

        .youtube-link svg {
            transition: transform 0.3s ease;
        }

        .youtube-link:hover svg {
            transform: scale(1.1);
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            gap: 2rem;
            margin-bottom: 3rem;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 8px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }

        .stat-item {
            text-align: center;
            flex: 1;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
        }

        .stat-value {
            font-family: 'Cinzel', serif;
            font-size: 2rem;
            font-weight: 600;
            color: var(--accent-gold);
        }

        .tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border);
        }

        .tab-btn {
            font-family: 'Cinzel', serif;
            padding: 1rem 2rem;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.1rem;
            cursor: pointer;
            letter-spacing: 2px;
            text-transform: uppercase;
            transition: all 0.3s ease;
            position: relative;
        }

        .tab-btn::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: var(--accent-fire);
            transition: width 0.3s ease;
        }

        .tab-btn:hover {
            color: var(--text-primary);
        }

        .tab-btn.active {
            color: var(--accent-fire);
        }

        .tab-btn.active::after {
            width: 100%;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section {
            margin-bottom: 2rem;
        }

        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--accent-gold);
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .section-title::before {
            content: '';
            width: 40px;
            height: 2px;
            background: linear-gradient(90deg, var(--accent-fire), transparent);
        }

        .quest-list {
            display: grid;
            gap: 1rem;
        }

        .quest-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            overflow: hidden;
        }

        .quest-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 4px;
            height: 100%;
            background: var(--accent-fire);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .quest-item:hover {
            background: var(--bg-tertiary);
            border-color: var(--accent-fire);
            box-shadow: 0 5px 20px var(--shadow);
            transform: translateX(5px);
        }

        .quest-item:hover::before {
            transform: scaleY(1);
        }

        .quest-item.completed {
            background: linear-gradient(135deg, rgba(45, 122, 74, 0.15) 0%, var(--bg-secondary) 100%);
            border-color: var(--completed);
        }

        .quest-item.completed::before {
            background: var(--completed);
        }

        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            flex-shrink: 0;
        }

        .quest-item.completed .checkbox {
            background: var(--completed);
            border-color: var(--completed);
        }

        .checkbox::after {
            content: 'âœ“';
            color: var(--text-primary);
            font-size: 1.2rem;
            opacity: 0;
            transform: scale(0);
            transition: all 0.3s ease;
        }

        .quest-item.completed .checkbox::after {
            opacity: 1;
            transform: scale(1);
        }

        .quest-info {
            flex: 1;
        }

        .quest-name {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 0.3rem;
            color: var(--text-primary);
        }

        .quest-details {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .timestamp-display {
            font-size: 0.85rem;
            color: var(--accent-ice);
            margin-top: 0.3rem;
            font-style: italic;
        }

        .timestamp-input {
            transition: all 0.3s ease;
        }

        .timestamp-input:focus {
            outline: none;
            border-color: var(--accent-ice) !important;
            box-shadow: 0 0 10px rgba(74, 157, 217, 0.3);
        }

        .timestamp-input:hover {
            border-color: var(--accent-ice) !important;
        }

        .quest-level {
            font-family: 'Cinzel', serif;
            padding: 0.3rem 0.8rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 4px;
            font-size: 0.9rem;
            color: var(--accent-gold);
            flex-shrink: 0;
        }

        .dlc-badge {
            font-family: 'Cinzel', serif;
            padding: 0.3rem 0.8rem;
            background: linear-gradient(135deg, var(--accent-ice), var(--accent-fire));
            border: 1px solid var(--accent-fire);
            border-radius: 4px;
            font-size: 0.8rem;
            color: var(--text-primary);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            flex-shrink: 0;
            margin-left: 0.5rem;
            box-shadow: 0 2px 10px rgba(217, 74, 43, 0.4);
        }

        .achievement-badge {
            font-family: 'Cinzel', serif;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            flex-shrink: 0;
            margin-left: 0.5rem;
        }

        .achievement-badge.bronze {
            background: linear-gradient(135deg, #cd7f32, #8b5a2b);
            border: 1px solid #cd7f32;
            color: var(--text-primary);
        }

        .achievement-badge.silver {
            background: linear-gradient(135deg, #c0c0c0, #808080);
            border: 1px solid #c0c0c0;
            color: var(--bg-primary);
        }

        .achievement-badge.gold {
            background: linear-gradient(135deg, #ffd700, #daa520);
            border: 1px solid #ffd700;
            color: var(--bg-primary);
        }

        .achievement-badge.platinum {
            background: linear-gradient(135deg, #e5e4e2, #a8a8a8);
            border: 1px solid #e5e4e2;
            color: var(--bg-primary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 0.5rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-fire), var(--accent-gold));
            border-radius: 10px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px var(--shadow);
        }

        .controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .playthrough-selector {
            display: flex;
            align-items: center;
            margin-right: auto;
        }

        .playthrough-selector select {
            transition: all 0.3s ease;
        }

        .playthrough-selector select:hover {
            border-color: var(--accent-fire);
            box-shadow: 0 0 10px var(--shadow);
        }

        .playthrough-selector select:focus {
            outline: none;
            border-color: var(--accent-gold);
        }

        .btn {
            font-family: 'Cinzel', serif;
            padding: 0.8rem 1.5rem;
            background: var(--bg-secondary);
            border: 2px solid var(--border);
            color: var(--text-primary);
            border-radius: 6px;
            cursor: pointer;
            letter-spacing: 1px;
            text-transform: uppercase;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--accent-fire);
            border-color: var(--accent-fire);
            box-shadow: 0 5px 20px var(--shadow);
            transform: translateY(-2px);
        }

        .filter-group {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            font-family: 'Cormorant Garamond', serif;
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border);
            color: var(--text-secondary);
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--accent-fire);
            border-color: var(--accent-fire);
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .stats-bar {
                flex-direction: column;
                gap: 1rem;
            }

            .tabs {
                flex-wrap: wrap;
            }

            .tab-btn {
                padding: 0.8rem 1rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>FINAL FANTASY XVI</h1>
            <div class="subtitle">Following Krystal109's 100% Guide</div>
            <a href="https://youtube.com/playlist?list=PLVBHCZXojrJetAgqxcpIyvX8D8zmotaj7&si=cMyIdx7TtBBjGjBo" target="_blank" class="youtube-link">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" style="margin-right: 0.5rem;">
                    <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                </svg>
                Watch on YouTube
            </a>
        </header>

        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-label">Completion</div>
                <div class="stat-value" id="mainProgress">0%</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Videos Watched</div>
                <div class="stat-value" id="sideProgress">0/50</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Time Watched</div>
                <div class="stat-value" id="huntProgress">0h 0m</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Time Progress</div>
                <div class="stat-value" id="totalProgress">0%</div>
            </div>
        </div>

        <div class="controls">
            <div class="playthrough-selector">
                <label for="playthrough-select" style="font-family: 'Cinzel', serif; color: var(--accent-gold); margin-right: 1rem; letter-spacing: 1px;">Playthrough:</label>
                <select id="playthrough-select" onchange="switchPlaythrough()" style="font-family: 'Cinzel', serif; padding: 0.5rem 1rem; background: var(--bg-secondary); border: 2px solid var(--border); color: var(--text-primary); border-radius: 6px; cursor: pointer; font-size: 1rem;">
                    <option value="1">First Playthrough</option>
                    <option value="2">New Game+ 1</option>
                    <option value="3">New Game+ 2</option>
                    <option value="4">New Game+ 3</option>
                    <option value="5">New Game+ 4</option>
                </select>
            </div>
            <button class="btn" onclick="resetProgress()">Reset Current</button>
            <button class="btn" onclick="resetAllProgress()">Reset All</button>
            <button class="btn" onclick="exportProgress()">Export Progress</button>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('walkthrough')">Walkthrough</button>
            <button class="tab-btn" onclick="switchTab('achievements')">Achievements</button>
        </div>

        <div id="walkthrough" class="tab-content active">
            <div class="section">
                <div class="section-title">Krystal109's 100% Walkthrough</div>
                <div class="quest-list" id="walkthrough-list"></div>
            </div>
        </div>

        <div id="achievements" class="tab-content">
            <div class="achievement-stats" style="margin-bottom: 2rem; padding: 1.5rem; background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px;">
                <div style="display: flex; justify-content: space-around; gap: 2rem; flex-wrap: wrap;">
                    <div style="text-align: center;">
                        <div style="font-family: 'Cinzel', serif; color: var(--accent-gold); font-size: 2rem;" id="achievement-progress">0/69</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">UNLOCKED</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-family: 'Cinzel', serif; color: var(--accent-gold); font-size: 2rem;" id="achievement-percent">0%</div>
                        <div style="color: var(--text-secondary); font-size: 0.9rem; margin-top: 0.5rem;">COMPLETION</div>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">Story</div>
                <div class="quest-list" id="story-achievements"></div>
            </div>
            
            <div class="section">
                <div class="section-title">Combat</div>
                <div class="quest-list" id="combat-achievements"></div>
            </div>
            
            <div class="section">
                <div class="section-title">Progression</div>
                <div class="quest-list" id="progression-achievements"></div>
            </div>
            
            <div class="section">
                <div class="section-title">Collectibles & Exploration</div>
                <div class="quest-list" id="collectibles-achievements"></div>
            </div>
            
            <div class="section">
                <div class="section-title">Difficulty</div>
                <div class="quest-list" id="difficulty-achievements"></div>
            </div>
            
            <div class="section">
                <div class="section-title">Echoes of the Fallen DLC</div>
                <div class="quest-list" id="dlc-echoes-achievements"></div>
            </div>
            
            <div class="section">
                <div class="section-title">The Rising Tide DLC</div>
                <div class="quest-list" id="dlc-rising-achievements"></div>
            </div>
        </div>
    </div>

    <script>
        const gameData = {
            walkthrough: [
                { part: 1, name: "Prologue", duration: "1:54:18" },
                { part: 2, name: "A Chance Encounter", duration: "59:48" },
                { part: 3, name: "Fanning Embers", duration: "1:16:39" },
                { part: 4, name: "Headwind", duration: "1:37:07" },
                { part: 5, name: "The Wages of Guilt", duration: "59:52" },
                { part: 6, name: "Homecoming", duration: "1:11:09" },
                { part: 7, name: "Holding On", duration: "1:05:29" },
                { part: 8, name: "Buried Memories", duration: "1:08:18" },
                { part: 9, name: "Righting Wrongs", duration: "1:28:25" },
                { part: 10, name: "The Dame", duration: "1:15:47" },
                { part: 11, name: "The Crystals' Curse", duration: "1:13:57" },
                { part: 12, name: "Home, Sweet Home", duration: "43:16" },
                { part: 13, name: "The Gathering Storm", duration: "1:02:49" },
                { part: 14, name: "Bloodlines", duration: "1:08:56" },
                { part: 15, name: "Here Be Monsters", duration: "55:32" },
                { part: 16, name: "Fire and Ice", duration: "1:17:24" },
                { part: 17, name: "After the Storm", duration: "48:47" },
                { part: 18, name: "Capital Punishment", duration: "54:09" },
                { part: 19, name: "Bolts from the Blue", duration: "1:17:21" },
                { part: 20, name: "Riddle of the Sands, Part 1", duration: "1:14:14" },
                { part: 21, name: "Riddle of the Sands, Part 2", duration: "36:13" },
                { part: 22, name: "Into the Darkness", duration: "1:12:46" },
                { part: 23, name: "Out of the Shadow, Part 1", duration: "1:20:56" },
                { part: 24, name: "Out of the Shadow, Part 2", duration: "1:47:05" },
                { part: 25, name: "Onward", duration: "1:38:03" },
                { part: 26, name: "Fire in the Sky", duration: "2:27:38" },
                { part: 27, name: "Things Fall Apart", duration: "1:23:27" },
                { part: 28, name: "Cloak and Dagger", duration: "59:35" },
                { part: 29, name: "Evenfall", duration: "39:44" },
                { part: 30, name: "A Song of Hope, Part 1", duration: "1:10:19" },
                { part: 31, name: "A Song of Hope, Part 2", duration: "1:33:59" },
                { part: 32, name: "Notorious Marks & Chronoliths", duration: "1:06:14" },
                { part: 33, name: "Notorious Marks & Chronoliths", duration: "1:31:02" },
                { part: 34, name: "Through the Maelstrom", duration: "53:58" },
                { part: 35, name: "Across the Narrow, Part 1", duration: "1:26:54" },
                { part: 36, name: "Across the Narrow, Part 2", duration: "1:58:32" },
                { part: 37, name: "Footfalls in Ash", duration: "1:18:31" },
                { part: 38, name: "The Last King", duration: "1:09:10" },
                { part: 39, name: "Brotherhood", duration: "1:27:49" },
                { part: 40, name: "Streets of Madness", duration: "1:22:55" },
                { part: 41, name: "Back to Their Origin Part 1", duration: "2:32:45" },
                { part: 42, name: "Back to Their Origin Part 2", duration: "2:57:41" },
                { part: 43, name: "Back to Their Origin Part 3", duration: "2:31:21" },
                { part: 44, name: "Notorious Marks & Chronoliths", duration: "1:34:36" },
                { part: 45, name: "Of Gods and Men", duration: "1:15:34" },
                { part: 46, name: "Echoes of the Fallen (DLC)", duration: "2:13:06", dlc: true },
                { part: 47, name: "The Rising Tide, Part 1 (DLC)", duration: "1:18:40", dlc: true },
                { part: 48, name: "The Rising Tide, Part 2 (DLC)", duration: "1:45:09", dlc: true },
                { part: 49, name: "The Rising Tide - Mysidia Side Quests (DLC)", duration: "2:31:50", dlc: true },
                { part: 50, name: "The Rising Tide - Chronolith & Ultima's Power (DLC)", duration: "53:59", dlc: true }
            ],
            achievements: {
                story: [
                    { name: "Rise from your reverie", description: "Complete A Chance Encounter", grade: "bronze" },
                    { name: "Inherit a power unknown", description: "Complete Headwind", grade: "bronze" },
                    { name: "Accept your fate", description: "Complete Buried Memories", grade: "bronze" },
                    { name: "Defy your fate", description: "Complete The Crystals' Curse", grade: "bronze" },
                    { name: "Turn the corner", description: "Complete Fire and Ice", grade: "bronze" },
                    { name: "Revisit the past", description: "Complete Capital Punishment", grade: "bronze" },
                    { name: "Exact revenge", description: "Complete Bolts from the Blue", grade: "bronze" },
                    { name: "Unite the flames", description: "Complete Out of the Shadow", grade: "bronze" },
                    { name: "Become one", description: "Complete Onward", grade: "bronze" },
                    { name: "Collect the final piece", description: "Complete Fire in the Sky", grade: "bronze" },
                    { name: "Escape the Darkness", description: "Complete The Last King", grade: "bronze" },
                    { name: "Fulfill a legacy", description: "Complete Back to Their Origin", grade: "bronze" }
                ],
                combat: [
                    { name: "Punisher", description: "Punish 10 enemies", grade: "bronze" },
                    { name: "You're Not the Boss of Me", description: "Defeat a boss without taking damage", grade: "bronze" },
                    { name: "Made to Be Broken", description: "Defeat 20 enemies while semi-primed", grade: "bronze" },
                    { name: "It's Over 50,000", description: "Deal 50,000 damage while enemy is staggered", grade: "bronze" },
                    { name: "Ignis", description: "Use Phoenix Shift 10 times in succession", grade: "bronze" },
                    { name: "Heatwave", description: "Execute 2 Heatwave Counters in a single battle", grade: "bronze" },
                    { name: "Phoenix Down", description: "Use Flames of Rebirth 5 times", grade: "bronze" },
                    { name: "Garuda's Gambit", description: "Use Garuda abilities to defeat 5 enemies", grade: "bronze" },
                    { name: "Wicked Whirlwind", description: "Use Aerial Blast 10 times in succession", grade: "bronze" },
                    { name: "Ramuh's Judgment", description: "Use Pile Drive or Thunderstorm 20 times", grade: "bronze" },
                    { name: "Shiva's Embrace", description: "Activate Diamond Dust 5 times", grade: "bronze" },
                    { name: "Titan's Might", description: "Use Windup 20 times successfully", grade: "bronze" },
                    { name: "Bahamut's Boon", description: "Use Wings of Light 10 times", grade: "bronze" },
                    { name: "Odin's Onslaught", description: "Use Zantetsuken 5 times", grade: "bronze" },
                    { name: "Good Boy", description: "Pet Torgal 5 times", grade: "bronze" },
                    { name: "Chocobo Jockey", description: "Ride Ambrosia for the first time", grade: "bronze" }
                ],
                progression: [
                    { name: "Master of One", description: "Master all of a single Eikon's abilities", grade: "silver" },
                    { name: "Masterclass", description: "Upgrade all feats and abilities to maximum", grade: "gold" },
                    { name: "Panacea", description: "Upgrade consumables and inventory to maximum", grade: "bronze" },
                    { name: "The Favor of the Fallen", description: "Obtain all available items from patrons", grade: "silver" },
                    { name: "Black Market", description: "Craft or upgrade 5 pieces of gear", grade: "bronze" },
                    { name: "Half Past Twilight", description: "Craft the ultimate weapon", grade: "silver" }
                ],
                collectibles: [
                    { name: "Mark of the Miscreant", description: "Defeat all notorious marks", grade: "silver" },
                    { name: "Chronolith Champion", description: "Complete a chronolith trial", grade: "bronze" },
                    { name: "For the Hoard", description: "Obtain all curiosities", grade: "silver" },
                    { name: "Here Be Rosefield", description: "Visit all areas on the maps (68 locations)", grade: "bronze" },
                    { name: "Sign of the Times", description: "Collect all six signboards", grade: "bronze" },
                    { name: "The Pen is Mightier", description: "Read 10 Thousand Tomes", grade: "bronze" }
                ],
                difficulty: [
                    { name: "Fantasy, Finally", description: "Complete the game on Final Fantasy mode", grade: "gold" }
                ],
                dlc_echoes: [
                    { name: "A Crystal Darkly", description: "Enter the Sagespire", grade: "bronze", dlc: "Echoes of the Fallen" },
                    { name: "The Only Way Is Up", description: "Defeat Aionios Malboro", grade: "bronze", dlc: "Echoes of the Fallen" },
                    { name: "Repercussion", description: "Silence the echoes", grade: "bronze", dlc: "Echoes of the Fallen" },
                    { name: "OMG", description: "Defeat Omega on Final Fantasy mode", grade: "bronze", dlc: "Echoes of the Fallen" },
                    { name: "Bit Fit", description: "Obtain all Fallen bits", grade: "bronze", dlc: "Echoes of the Fallen" },
                    { name: "My Reward Is with Me", description: "Obtain the Omega Weapon", grade: "bronze", dlc: "Echoes of the Fallen" }
                ],
                dlc_rising_tide: [
                    { name: "The Calm", description: "Find again what was lost", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Homecoming", description: "Complete Away", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Flow", description: "Complete Tidal Wave Part 1", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Flood", description: "Complete Tidal Wave Part 2", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "The End Can Wait", description: "Complete The Sins of Dzemekys", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Tideslinger", description: "Use Tidal Roar 10 times", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Supersoaker", description: "Use Hydrostorm 5 times", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Deus Ex", description: "Defeat Leviathan on Final Fantasy mode", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "A Most Worthy Vessel", description: "Master all of Leviathan's abilities", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Still Breathing", description: "Complete Trial by Water", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Occasio Calva", description: "Complete all Kairos Gate stages", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "Explain That Thou Brakest the Head", description: "Complete Laid to Rest", grade: "bronze", dlc: "The Rising Tide" },
                    { name: "And Who Made Leviathan?", description: "Master Leviathan and Ultima combined", grade: "bronze", dlc: "The Rising Tide" }
                ]
            }
        };

        let currentPlaythrough = parseInt(localStorage.getItem('ff16CurrentPlaythrough')) || 1;
        let progress = JSON.parse(localStorage.getItem('ff16Progress')) || {
            playthroughs: {
                1: []
            },
            achievements: [],
            timestamps: {}
        };

        // Ensure current playthrough exists in progress
        if (!progress.playthroughs[currentPlaythrough]) {
            progress.playthroughs[currentPlaythrough] = [];
        }
        
        // Ensure achievements array exists
        if (!progress.achievements) {
            progress.achievements = [];
        }
        
        // Ensure timestamps object exists
        if (!progress.timestamps) {
            progress.timestamps = {};
        }

        function initializeTracker() {
            document.getElementById('playthrough-select').value = currentPlaythrough;
            renderWalkthrough();
            renderAchievements();
            updateProgress();
        }

        function renderAchievements() {
            renderAchievementCategory('story-achievements', gameData.achievements.story);
            renderAchievementCategory('combat-achievements', gameData.achievements.combat);
            renderAchievementCategory('progression-achievements', gameData.achievements.progression);
            renderAchievementCategory('collectibles-achievements', gameData.achievements.collectibles);
            renderAchievementCategory('difficulty-achievements', gameData.achievements.difficulty);
            renderAchievementCategory('dlc-echoes-achievements', gameData.achievements.dlc_echoes);
            renderAchievementCategory('dlc-rising-achievements', gameData.achievements.dlc_rising_tide);
            updateAchievementProgress();
        }

        function renderAchievementCategory(containerId, achievements) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            
            achievements.forEach((achievement, index) => {
                const achievementId = `${containerId}-${index}`;
                const isUnlocked = progress.achievements.includes(achievementId);
                const achievementItem = document.createElement('div');
                achievementItem.className = `quest-item ${isUnlocked ? 'completed' : ''}`;
                achievementItem.onclick = () => toggleAchievement(achievementId);
                
                const dlcBadge = achievement.dlc ? `<span class="dlc-badge">${achievement.dlc}</span>` : '';
                
                achievementItem.innerHTML = `
                    <div class="checkbox"></div>
                    <div class="quest-info">
                        <div class="quest-name">${achievement.name}</div>
                        <div class="quest-details">${achievement.description}</div>
                    </div>
                    <span class="achievement-badge ${achievement.grade}">${achievement.grade}</span>
                    ${dlcBadge}
                `;
                
                container.appendChild(achievementItem);
            });
        }

        function toggleAchievement(achievementId) {
            const idx = progress.achievements.indexOf(achievementId);
            if (idx > -1) {
                progress.achievements.splice(idx, 1);
            } else {
                progress.achievements.push(achievementId);
            }
            
            localStorage.setItem('ff16Progress', JSON.stringify(progress));
            renderAchievements();
        }

        function updateAchievementProgress() {
            const totalAchievements = 69; // 50 base + 6 Echoes + 13 Rising Tide
            const unlockedCount = progress.achievements.length;
            const percent = Math.round((unlockedCount / totalAchievements) * 100);
            
            document.getElementById('achievement-progress').textContent = `${unlockedCount}/${totalAchievements}`;
            document.getElementById('achievement-percent').textContent = `${percent}%`;
        }

        function renderWalkthrough() {
            const container = document.getElementById('walkthrough-list');
            container.innerHTML = '';
            
            const currentProgress = progress.playthroughs[currentPlaythrough] || [];
            
            gameData.walkthrough.forEach((video, index) => {
                const isCompleted = currentProgress.includes(index);
                const videoItem = document.createElement('div');
                videoItem.className = `quest-item ${isCompleted ? 'completed' : ''}`;
                
                const dlcBadge = video.dlc ? '<span class="dlc-badge">DLC</span>' : '';
                const timestampKey = `${currentPlaythrough}-${index}`;
                const savedTimestamp = progress.timestamps[timestampKey] || '';
                
                // Create timestamp display
                const timestampDisplay = savedTimestamp 
                    ? `<div class="timestamp-display">Paused at: ${savedTimestamp}</div>`
                    : '';
                
                videoItem.innerHTML = `
                    <div class="checkbox" onclick="toggleVideo(${index}); event.stopPropagation();"></div>
                    <div class="quest-info" style="flex: 1;">
                        <div class="quest-name">Part ${video.part} - ${video.name}</div>
                        <div class="quest-details">Duration: ${video.duration}</div>
                        ${timestampDisplay}
                    </div>
                    <div style="display: flex; gap: 0.5rem; align-items: center; flex-shrink: 0;">
                        <input 
                            type="text" 
                            class="timestamp-input" 
                            placeholder="00:00" 
                            value="${savedTimestamp}"
                            onclick="event.stopPropagation();"
                            onchange="saveTimestamp(${index}, this.value)"
                            maxlength="8"
                            style="width: 70px; padding: 0.4rem; background: var(--bg-tertiary); border: 1px solid var(--border); color: var(--text-primary); border-radius: 4px; font-family: 'Cormorant Garamond', serif; text-align: center;"
                        />
                        <div class="quest-level">Part ${video.part}</div>
                        ${dlcBadge}
                    </div>
                `;
                
                container.appendChild(videoItem);
            });
        }

        function toggleVideo(index) {
            if (!progress.playthroughs[currentPlaythrough]) {
                progress.playthroughs[currentPlaythrough] = [];
            }
            
            const idx = progress.playthroughs[currentPlaythrough].indexOf(index);
            if (idx > -1) {
                progress.playthroughs[currentPlaythrough].splice(idx, 1);
            } else {
                progress.playthroughs[currentPlaythrough].push(index);
                // Clear timestamp when marking as complete
                const timestampKey = `${currentPlaythrough}-${index}`;
                delete progress.timestamps[timestampKey];
            }
            
            localStorage.setItem('ff16Progress', JSON.stringify(progress));
            initializeTracker();
        }

        function saveTimestamp(index, value) {
            const timestampKey = `${currentPlaythrough}-${index}`;
            
            // Validate and format timestamp (HH:MM:SS or MM:SS)
            const cleanValue = value.trim();
            if (cleanValue === '') {
                delete progress.timestamps[timestampKey];
            } else {
                progress.timestamps[timestampKey] = cleanValue;
            }
            
            localStorage.setItem('ff16Progress', JSON.stringify(progress));
            renderWalkthrough();
        }

        function switchPlaythrough() {
            currentPlaythrough = parseInt(document.getElementById('playthrough-select').value);
            localStorage.setItem('ff16CurrentPlaythrough', currentPlaythrough);
            
            if (!progress.playthroughs[currentPlaythrough]) {
                progress.playthroughs[currentPlaythrough] = [];
            }
            
            initializeTracker();
        }

        function updateProgress() {
            const currentProgress = progress.playthroughs[currentPlaythrough] || [];
            const totalVideos = gameData.walkthrough.length;
            const completedVideos = currentProgress.length;
            const overallPercent = Math.round((completedVideos / totalVideos) * 100);
            
            // Calculate time-based progress
            let totalMinutes = 0;
            let completedMinutes = 0;
            
            gameData.walkthrough.forEach((video, index) => {
                // Parse duration - handle both HH:MM:SS and MM:SS formats
                const parts = video.duration.split(':').map(Number);
                let videoMinutes = 0;
                
                if (parts.length === 3) {
                    // HH:MM:SS format
                    videoMinutes = (parts[0] * 60) + parts[1] + (parts[2] / 60);
                } else if (parts.length === 2) {
                    // MM:SS format
                    videoMinutes = parts[0] + (parts[1] / 60);
                }
                
                totalMinutes += videoMinutes;
                
                if (currentProgress.includes(index)) {
                    completedMinutes += videoMinutes;
                }
            });
            
            const timePercent = Math.round((completedMinutes / totalMinutes) * 100) || 0;
            const hours = Math.floor(completedMinutes / 60);
            const minutes = Math.floor(completedMinutes % 60);
            
            document.getElementById('mainProgress').textContent = `${overallPercent}%`;
            document.getElementById('sideProgress').textContent = `${completedVideos}/${totalVideos}`;
            document.getElementById('huntProgress').textContent = `${hours}h ${minutes}m`;
            document.getElementById('totalProgress').textContent = `${timePercent}%`;
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        function resetProgress() {
            if (confirm(`Are you sure you want to reset ${getPlaythroughName(currentPlaythrough)}? This will also clear all timestamps for this playthrough.`)) {
                progress.playthroughs[currentPlaythrough] = [];
                
                // Clear timestamps for this playthrough
                Object.keys(progress.timestamps).forEach(key => {
                    if (key.startsWith(`${currentPlaythrough}-`)) {
                        delete progress.timestamps[key];
                    }
                });
                
                localStorage.setItem('ff16Progress', JSON.stringify(progress));
                initializeTracker();
            }
        }

        function resetAllProgress() {
            if (confirm('Are you sure you want to reset ALL playthroughs, achievements, and timestamps? This cannot be undone.')) {
                progress = {
                    playthroughs: {
                        1: []
                    },
                    achievements: [],
                    timestamps: {}
                };
                currentPlaythrough = 1;
                localStorage.setItem('ff16Progress', JSON.stringify(progress));
                localStorage.setItem('ff16CurrentPlaythrough', 1);
                initializeTracker();
            }
        }

        function getPlaythroughName(num) {
            if (num === 1) return 'First Playthrough';
            return `New Game+ ${num - 1}`;
        }

        function exportProgress() {
            const dataStr = JSON.stringify(progress, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'ff16-progress.json';
            link.click();
        }

        initializeTracker();
    </script>
</body>
</html>